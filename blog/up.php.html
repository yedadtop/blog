<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<title>åšå®¢é™æ€åŒ– & æ¨é€</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;background:#f5f5f5;color:#333}
.container{max-width:720px;margin:60px auto;padding:30px;background:#fff;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.08)}
h1{margin:0 0 20px;font-size:28px;font-weight:600}
.btn-group{display:flex;gap:12px;margin-bottom:20px;flex-wrap:wrap}
.btn{display:inline-block;padding:12px 24px;font-size:16px;font-weight:500;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:background .2s;text-decoration:none}
.btn-primary{background:#007bff}
.btn-primary:hover{background:#0056b3}
.btn-success{background:#28a745}
.btn-success:hover{background:#1e7e34}
.btn-warning{background:#ffc107;color:#212529}
.btn-warning:hover{background:#e0a800}
.log{background:#000;color:#0f0;font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:14px;padding:15px;border-radius:4px;height:320px;overflow:auto;margin-top:20px;white-space:pre-wrap}
.status{margin:10px 0;padding:10px;border-radius:4px;background:#f8f9fa}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ“„ åšå®¢é™æ€åŒ– & FTP æ¨é€</h1>
  <p>é€‰æ‹©è¦æ‰§è¡Œçš„æ“ä½œï¼š</p>
  
  <div class="btn-group">
    <button class="btn btn-primary" onclick="runAction('generate')">ğŸ•·ï¸ ä»…ç”Ÿæˆé™æ€</button>
    <button class="btn btn-success" onclick="runAction('push')">ğŸš€ ä»…æ¨é€</button>
    <button class="btn btn-warning" onclick="runAction('run')">âš¡ ä¸€é”®æ‰§è¡Œ</button>
  </div>

  <div id="status" class="status"></div>
  <div id="log" class="log"></div>
</div>

<script>
function runAction(action) {
  const log = document.getElementById('log');
  const status = document.getElementById('status');
  
  // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
  switch(action) {
    case 'generate':
      status.innerHTML = '<strong>çŠ¶æ€ï¼š</strong>æ­£åœ¨ç”Ÿæˆé™æ€èµ„æº...';
      break;
    case 'push':
      status.innerHTML = '<strong>çŠ¶æ€ï¼š</strong>æ­£åœ¨æ¨é€æ–‡ä»¶...';
      break;
    case 'run':
      status.innerHTML = '<strong>çŠ¶æ€ï¼š</strong>æ­£åœ¨ä¸€é”®æ‰§è¡Œç”Ÿæˆå’Œæ¨é€...';
      break;
  }
  
  log.textContent = 'â–¶ï¸ å¼€å§‹æ‰§è¡Œ...\n';
  
  fetch('?action=' + action).then(r => {
    const reader = r.body.getReader();
    const decoder = new TextDecoder();
    function pump() {
      return reader.read().then(({done, value}) => {
        if (done) { 
          log.textContent += '\nâœ… æ“ä½œå®Œæˆ'; 
          status.innerHTML += ' <strong>âœ… å®Œæˆ</strong>';
          return; 
        }
        log.textContent += decoder.decode(value, {stream: true});
        log.scrollTop = log.scrollHeight;
        return pump();
      });
    }
    return pump();
  }).catch(err => {
    log.textContent += '\nâŒ è¯·æ±‚å¤±è´¥: ' + err;
    status.innerHTML += ' <strong>âŒ å¤±è´¥</strong>';
  });
}
</script>
</body>
</html>
